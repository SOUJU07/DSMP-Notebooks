-- Q-1 Find out top 10 countries' which have maximum A and D values.

SELECT t1.country,SUM(a),SUM(b),SUM(a)+SUM(b) as total
FROM country_ab t1
JOIN country_cd t2
ON t1.Country=t2.Country
GROUP BY t1.country
ORDER BY total DESC
LIMIT 10;

-- Q-2 Find out highest CL value for 2020 for every region. 
-- Also sort the result in descending order. Also display the CL values in descending order.

SELECT t1.region,t2.edition,MAX(t2.CL)
FROM country_efg t1
JOIN country_cl t2
ON t1.Country=t2.country
WHERE t2.Edition=2020
GROUP BY t1.region
ORDER BY MAX(t2.cl) DESC;


-- Q-3 Find top-5 most sold products.

SELECT Name,SUM(Quantity) as total
FROM sales1 t1
JOIN products t2
ON t1.productID=t2.productID
GROUP BY t1.ProductID
ORDER BY total DESC
LIMIT 5;


-- Q-4: Find sales man who sold most no of products.
SELECT t2.EmployeeID,t2.FirstName,SUM(t1.Quantity) as total
FROM sales1 t1
JOIN employees t2
ON t1.SalesPersonID=t2.EmployeeID
GROUP BY t2.EmployeeID,t2.FirstName
ORDER BY total DESC;

-- Q-5: Sales man name who has most no of unique customer.

SELECT t2.EmployeeID,t2.FirstName,COUNT(DISTINCT t1.CustomerID) as total
FROM sales1 t1
JOIN employees t2
ON t1.SalesPersonID=t2.EmployeeID
GROUP BY t2.EmployeeID,t2.FirstName
ORDER BY total DESC;

-- Q-6: Sales man who has generated most revenue. Show top 5.

SELECT t1.SalesPersonID,t2.FirstName,ROUND(SUM(quantity * price),2) as total
FROM sales1 t1
JOIN employees t2
ON t1.SalesPersonID=t2.EmployeeID
JOIN products t3
ON t3.ProductID = t1.ProductID
GROUP BY t1.SalesPersonID,t2.FirstName
ORDER BY total DESC
LIMIT 5;

-- Q-7: List all customers who have made more than 10 purchases.

SELECT t1.CustomerID,t2.FirstName,COUNT(*) as total
FROM sales1 t1
JOIN customers t2
ON t1.CustomerID=t2.CustomerID
GROUP BY t1.customerID,t2.FirstName
HAVING total > 10;

-- Q-8 : List all salespeople who have made sales to more than 5 customers.

SELECT t2.EmployeeID,t2.FirstName,COUNT(DISTINCT t1.CustomerID) as total
FROM sales1 t1
JOIN employees t2
ON t1.SalesPersonID=t2.EmployeeID
GROUP BY t2.EmployeeID,t2.FirstName
HAVING total > 5
ORDER BY total DESC;

-- Q-9: List all pairs of customers who have made purchases with the same salesperson.

SELECT DISTINCT t1.CustomerID as fc,
t2.CustomerID as sc,
t1.SalesPersonID as sp
FROM sales1 t1
JOIN sales1 t2
ON t1.SalesPersonID=t2.SalesPersonID
AND t1.CustomerID != t2.CustomerID;

